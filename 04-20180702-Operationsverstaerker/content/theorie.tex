\section{Theorie}\label{sec:theorie}
Mit dem Operationsverstärker lässt sich eine Ausgangsspannung $U_A$
erzeugen, welche in einem Bereich proportional zur Differenz der beiden
angelegten Eingangsspannungen ist.
Ziel des Versuches ist es, verschiedene Schaltungen mittels eines
Operationsverstärkers zu realisieren und die Unterschiede zwischen einem idealen
und realen Operationsverstärkers zu veranschaulichen.

\subsection{Idealer Operationsverstärker}%
\label{sub:idealer_operationsverstaerker}

\begin{wrapfigure}{l}{0.4\textwidth}
		\centering
		\includegraphics[width=\linewidth]{./build/operationsverstaerker.pdf}
		\caption{Schaltbild eines idealen Operationsverstärkers.
		\cite{anleitung}}
		\label{fig:opv}
\end{wrapfigure}
In einem Schaltbild wird ein Operationsverstärker durch ein gleichseitiges
Dreieck gekennzeichnet (siehe Abbildung \ref{fig:opv}).
An diesem werden zwei Eingangsspannungen angelegt, wobei die
Eingangsspannungen $U_\text{P}$ in Phase
und $U_\text{N}$ in Gegenphase zur Ausgangsspannung
$U_\text{A}$ ist.
Der Eingang $U_\text{P}$ wird aufgrund seiner Phasenbeziehung zur Ausgangsspannung
als nicht-invertierender und $U_\text{N}$ als invertierender Eingang bezeichnet.
Im linearen Aussteuerungsbereich verstärkt der Operationsverstärker die
Differenz zwischen den beiden Eingängen mit dem Verstärkungsfaktor $V$ linear
\begin{equation}
		\label{eq:diff}
		U_\text{A} = V \left( U_\text{P} - U_\text{N} \right)
\end{equation}
woraufhin die Ausgangsspannung bei größeren Eingangsspannungen gegen einen
Sättigungswert strebt.
Der Verstärkungsfaktor ist durch die Betriebspannung $U_\text{B}$ festgelegt
, wobei die Betriebspannung $U_\text{B}$ den Sättigungswert $\pm U_\text{B}$ des
Linearverstärkers bildet.
In Abbildung \ref{fig:kennlinie} ist eine beispielhafte Kennlinie eines
Operationsverstärkers zu sehen.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/aussteuerungsbereich.pdf}
		\caption{Kennlinie eines Operationsverstärkers. \cite{anleitung}}
		\label{fig:kennlinie}
\end{figure}
Für den idealen Operationsverstärker werden die Annahmen getroffen, dass der
Verstärkungsfaktor $V = \infty$, die beiden Eingangs-Widerstände $r_\text{e} 
= \infty$ und der Ausgangs-Widerstand $r_\text{a} = 0$ ist.
Die Annahmen des idealen Operationsverstärkers beschreiben aber nur begrenzt
die Realität, weswegen Korrekturterme eingeführt werden.

\subsection{Realer Operationsverstärker}%
\label{sub:realer_operationsverstaerker}

Zur Beschreibung eines realen Operationsverstärkers müssen noch Korrekturterme
eingeführt werden, welche beim idealen OP verschwinden.
Wird auf beiden Eingängen dieselbe Spannung $U_\text{Gl}$ angelegt, so
verschwindet nach Formel (\ref{eq:diff}) die Ausgangsspannung beim idealen
Operationsverstärker.
Beim realen OP werden aufgrund von Unsymmetrien dennoch Spannungen gemessen so, dass
die Gleichtaktverstärkung
\begin{equation}
		V_\text{Gl} = \frac{\Delta U_\text{A}}{\Delta U_\text{Gl}}
\end{equation}
definiert werden kann.
Ebenso sind die Eingangs-Widerstände endlich, sodass es zu Eingangsströmen auf
den beiden Eingängen $I_\text{p}$ und $I_\text{n}$ kommt.
Der Offset-Strom wird als Differenz beider Ströme definiert
\begin{equation}
  I_0 = I_\text{p} - I_\text{n}\text{,}
\end{equation}
wenn beide Eingangsspannungen verschwinden.
Der Eingangsruhestrom $I_\text{B}$ ergibt sich aus dem Mittel der beiden Eingangsströme.
Für den Fall, dass eine Eingangsspannung $U_{i}$ verschwindet, ergibt sich der
Differenzeingangswiderstand $r_\text{D}$ zu
\begin{equation}
		r_\text{D} = \frac{\Delta U_\text{i}}{\Delta I_\text{i}} \hspace{2cm} U_\text{j} = 0
\end{equation}
wobei $i,j \in p,n$ und $i \neq j$.
Der Gleichtakt-Eingangswiderstand ist definiert über die Gleichtaktsspannung
$U_\text{GL}$ und dem Gleichtaktsstrom $I_\text{Gl} = I_\text{p} + I_\text{n}$.
Die Offset-Spannung $U_0$ ist die Spannungdifferenz, um die die Eingänge
verschoben werden müssen, damit die Ausgangsspannung $U_\text{a}$ verschwindet
\begin{equation}
		U_0 = U_\text{p} - U_\text{n} \, , \hspace{1cm} \text{für } U_\text{A} = 0.
\end{equation}

\subsection{Linearverstärker}%
\label{sub:linearverstaerker}
Aufgrund des schmalen Aussteuerungsberreich sind Linearverstärker nur
begrenzt einsetzbar.
Zur Verbreiterung des Aussteuerungsbereich wird der Operationsverstärker mit einem
Gegenkopplungzweig beschaltet.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/linearverstaerker.pdf}
		\caption{Gegengekoppelter Linearverstärker.\cite{anleitung}}
		\label{fig:lin}
\end{figure}
Dabei wird ein Teil der Ausgangsspannung über den Widerstand $R_\text{n}$ des
Gegenkopplungszweiges zum invertierten Eingang zurück gegeben.
Dadurch lässt sich eine Zunahme des Aussteuerungsberreich erreichen, wobei die
Verstärkung abnimmt.
Bei großen Leerlaufverstärkungen ist die Spannung $U_\text{n}$ gering, sodass
sich nach dem ersten Kirchhoff'schen Gesetz für den Knoten A (vgl. Abbildung~\ref{fig:lin})
\begin{equation}
		\frac{U_1}{R_1} + \frac{U_\text{A}}{R_\text{n}} = 0
\end{equation}
der Strom Verschwinden muss.
Aus dem Verhältnis der Eingangsspannung $U_1$ zur Ausgangsspannung $U_\text{A}$ ergibt
sich der Verstärkungsfaktor
\begin{equation}
		V' = - \frac{R_\text{N}}{R_1}.
\end{equation}
Die Verstärkung ist im Idealfall nur von dem Verhältnis der beiden
Widerstände abhängig, da die Spannung am nicht invertierenden Eingang $U_\text{N}
= 0$ verschwindet.
Im Realfall bestehen noch Abhängigkeiten zwischen der Leerlaufverstärkung,
den Eingangs- und Ausgangs-Widerständen usw.
Für einen unbelasteten Spannungsteiler ($I_\text{n} = 0$) gilt,
dass bei einem endlichen Leerlaufverstärkungsfaktor $V$ die Spannung
\begin{equation}
		U_\text{N} = - \frac{U_\text{A}}{V}
\end{equation}
für den Punkt $A$ anhand der 1. Kirchhoff'schen Regel gilt:
\begin{equation}
		\frac{U_\text{N}-U_1}{U_\text{A}-U_1} = \frac{R_1}{R_1 + R_\text{N}} \,  .
\end{equation}
% Daraus resultiert für den Verstärkungsfaktor
% \begin{equation}
%   \label{eq:v_strich}
% 		\frac{1}{V'}= - \frac{U_1}{U_\text{A}} = \frac{1}{V} +
% 		\frac{R_1}{R_\text{N}} \left( a + \frac{1}{V} \right) \approx
% 		\frac{1}{V} + \frac{R_1}{R_\text{N}},
% \end{equation}
% sodass bei der Wahl von $R_\text{n}/ R_\text{1}$ viel kleiner als die
% Leerlaufverstärkung $V$ ein idealer Operationsverstärker entsteht mit einem
% geringeren Verstärkungsgrad,
% wobei der Verstärkungsfaktor nur vom Verhältnis der Widerstände abhängt.
Es entsteht, bei der Wahl von $R_\text{n}/ R_\text{1}$ viel kleiner als die
Leerlaufverstärkung $V$, ein idealer Operationsverstärker mit einem Verstärkungsfaktor
\begin{equation}
  \label{eq:v_strich}
		\frac{1}{V'}= - \frac{U_1}{U_\text{A}} = \frac{1}{V} +
		\frac{R_1}{R_\text{N}} \left( a + \frac{1}{V} \right) \approx
		\frac{1}{V} + \frac{R_1}{R_\text{N}},
\end{equation}
wobei der Verstärkungsfaktor nur vom Verhältnis der Widerstände abhängt.
Desweiteren wird durch die Gegenkopplung die Stabilität der
Verstärkerschaltung erhöht, sowie der Ausgangs-Widerstand um einen
Faktor $g$ verkleinert:
\begin{equation}
		g := \frac{V}{V'} \, .
\end{equation}
Äquivalent werden die nicht-kontrollierbaren Schwankungen vermindert:
\begin{equation}
		\frac{\Delta V'}{V'} = \frac{\Delta V}{g V} \, .
\end{equation}
Ebenso nimmt die Bandbreite $\Delta \omega$ für große $g$ zu, sodass aufgrund eines großeren
Frequenzbandes mehr Frequenzen unverzerrt verstärkt werden können.
Die Transitfrequenz $\nu_\text{g}$ ist durch das Produkt aus Verstärkung und
Bandbreite definiert, welches bei gegengekoppelten Zweigen eine Konstante
bildet.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/frequenz_lin.pdf}
		\caption{Charakteristische Bandbreite eines Operationsverstärkers.\cite{anleitung}}
		\label{fig:freq}
\end{figure}
Dies ist die Frequenz, bei dem die Verstärkung den Wert 1 annimmt.
Eine charakteristische Bandbreite eines Operationsverstärkers ist in Abbildung
\ref{fig:freq} zu sehen.

\subsection{Tiefpass}%
\label{sub:tiefpass}

Der Verstärkungsfaktor des Operationsverstärkers aufgetragen gegen die Frequenz bildet ein typischen Tiefpass.
Bei diesem werden hohe Frequenzen stark gedämpft.
Beispielhaft ist in Abbildung \ref{fig:tiefpass} ein Tiefpass erster Ordnung
dargestellt.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/tiefpass.pdf}
		\caption{Simpler Tiefpass erster Ordnung. \cite{wiki}}
		\label{fig:tiefpass}
\end{figure}
Unter Berücksichtigung der Maschenregel lässt sich der Verstärkungs- bzw.
Dämpfungsfaktor des Tiefpass ausdrücken.
Dazu wird das Verhältnis aus $U_a$ zu $U_e$ gebildet woraus sich der
Blindwiderstand $H$ ergibt.
\begin{equation}
		\label{eq:blindwiederstand}
		H = \frac{Z_\text{C}}{Z_\text{C} + R}
\end{equation}
Der Blindwiderstand $H$ ist eine Funktion der Wechselspannungfrequenz $\omega$
und dessen Realteil entspricht
\begin{align}
		\Re(H(\omega))  &= \Re \left(\frac{\sfrac{1}{j \omega C}}{\sfrac{1}{j\omega
		C} + R} \right) \nonumber \\
		&= \frac{1}{\sqrt{1 + (\frac{\omega}{\Delta \omega} )^2}} \,
		\hspace{1cm} \text{mit} \Delta \omega = \frac{1}{RC}
		\label{eq:tiefpass}
\end{align}
dem \enquote{Ersatzwiderstand}.
Für Frequenzen oberhalb der Bandbreite $\Delta \omega$ wird die Eingangsspannung 
stark gedämpft und bildet die abfallende Flanke in Abbildung \ref{fig:freq}.

\subsection{Umkehr-Integrator}%
\label{sub:umkehr_integrator}

Durch Rückkopplung des Ausgangsstroms über ein Kondensator lässt sich die
Eingangsspannung $U_1$ integrieren (vergleiche Abbildung \ref{fig:integrator}).
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/umkehr_integrator.pdf}
		\caption{Umkehrgenerator \cite{anleitung}}
		\label{fig:integrator}
\end{figure}
Die Rückkopplung funktioniert äquivalent zum Linearverstärker.
Die Ladung auf dem Kondensator entspricht dem Produkt aus der Ausgangsspannung
$U_\text{A}$ und der Kapazität $C$.
\begin{equation}
		\int I_\text{C} \, \text{dt} = C U_\text{A}
\end{equation}
Unter der Vernachlässigung des Operationsverstärkerstroms $I_\text{N}$ gilt
für den Knotenpunkt A:
\begin{align}
		0 = \sum_i I_i =& I_1 + I_\text{N} + I_\text{C} \nonumber \\
		=& \frac{U_1(t)}{R} + 0 + C \cdot \frac{\text{d} U_\text{A}(t)}{\text{dt}}
\end{align}
Unter Berücksichtigung, dass die Eingangsspannung von der Zeit abhängt (z.B.
sinusförmig $U_1(t)= U_0 \cos(\omega t)$) ergibt sich die Integration der Eingangsspannung $U_1$ nach der Zeit:
\begin{align}
		U_\text{A}(t) &= - \frac{1}{RC} \int U_\text{1}(t) \, \text{dt} \nonumber \\
                  &= \frac{U_0}{\omega R C} \cos (\omega t) \label{eq:integrator}
\end{align}
Für eine sinusförmige Eingangsspannung fällt die Verstärkung daher linear mit
der Frequenz.
Im Allgemeinen können beliebige Funktionen integriert werden, wobei es bei
Unstetigkeiten zu Überschwingungen kommen kann (Gibbs'sches Phänomen).

\subsection*{Umkehr-Differentiator}%
\label{sub:umkehr_differentiator}
Äquivalent zum Integrator lässt sich durch Austauschen der Kapazität durch
den Widerstand vice versa die Eingangsspannung differenzieren.
Ein Schaltbild des Umkehr-Differentiators ist in Abbildung~\ref{fig:diff} zu
sehen.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/umkehr_diff.pdf}
		\caption{Schaltbild des Umkehr-Differentiators.\cite{anleitung}}
		\label{fig:diff}
\end{figure}
Für den Knotenpunkt vor dem nicht-invertierenden Eingang gilt nach der ersten
Kirchhoff'schen Regel:
\begin{equation}
		C \frac{\text{d} U_1(t)}{\text{dt}} + \frac{U_A(t)}{R} = 0 \, .
\end{equation}
Durch Umstellen und einmaliges Differenzieren ergibt sich beispielsweise für
eine sinusförmige Eingangsspannung $U_1(t)$
\begin{align}
		U_\text{A}(t) &= - RC \frac{\text{d}U_1(t)}{\text{dt}} \nonumber \\
                  &= - \omega R C U_0 \cos(\omega t) \label{eq:differentiator} \, .
\end{align}
Beim Differenzieren wächst die Verstärkung bei einer sinusförmigen
Eingangsspannung linear mit der Frequenz.

\subsection{Schmitt-Trigger}%
\label{sub:schmitt_trigger}

Beim Schmitt-Trigger wird ein Teil der Ausgangsspannung auf den
nicht-invertierenden Eingang zurückgegeben.
Dies wird als Mitkopplung bezeichnet.
Es lässt sich für den Knoten vor dem rückgekoppelten Eingang die Gleichung
\begin{equation}
		\frac{U_1}{R_1} + \frac{U_\text{A}}{R_\text{p}} = 0
\end{equation}
aufstellen.
Der Schmitt-Trigger dient als Linearverstärker bis die Ungleichung 
\begin{equation}
		\label{eq:schmitt}
		U_1 > \frac{R_1}{R_\text{P}} U_\text{B} \ .
\end{equation}
erfüllt wird. 
Sinkt die Eingangsspannung unter den Wert 
\begin{equation}
		% \label{eq:schmitt}
		\label{eq:m_ub}
		U_1 < - \frac{R_1}{R_\text{P}} U_\text{B} \ .
\end{equation}
fällt der Wert auf den negativen Sättigungswert $-U_\text{B}$.
Durch den Schmitt-Trigger welcher den Bistabile Kippstufe untergeordent werden
kann, lassen sich Beispielsweise Rechteckspannungen erzeugen.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\linewidth]{build/schmitt_trigger.pdf}
		\caption{Schaltbild eines Schmitt-Triggers. \cite{anleitung}}
		\label{fig:schmitt}
\end{figure}
Schmitt-Trigger werden zur Erzeugung von binären Signalen und der
Signalverstärkung genutzt.

\subsection{Rechteck- und Dreieck-Signalgenerator}%
\label{sub:signalgenerator}

Zum Betreiben eines Rechteck- und Dreieck-Signalgenerator werden
ein Schmitt-Trigger sowie ein Differentiator benötigt (siehe Abbildung
\ref{fig:sig}).
Dazu wird, die mit dem Schmitt-Trigger erzeugte, konstante Ausgangsspannung $U_\text{B}$
auf den nicht-invertierenden Eingang des Differentiator gelegt.
Der Differentiator erzeugt eine Flanke eines Dreiecksignals $U_\text{A}$
welche wiederum auf den Schmitt-Trigger zurückgegeben wird.
% Durch das Anregen des Schmitt-Triggers mit einer Sinusspannung wird bei
% entsprechender Wahl der Widerstände und hinreichend großen Eingangspannungen, am Ausgang ein Rechtecksignal erzeugt.
% Der Ausgang des Schmitt-Triggers wird auf den Eingang eines daran anschließenden
% Integrators gelegt.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.8\linewidth]{build/dreiecksgen.pdf}
		\caption{Schaltbild eines Rechteck- sowie Dreieck-Signalgenerators. \cite{anleitung}}
		\label{fig:sig}
\end{figure}
Übersteigt die Rückgekoppelte Spannung den Wert der Ungleichung (\ref{eq:m_ub})
so kippt der Schmitt-Trigger auf den Wert $-U_\text{B}$.
Dies erzeugt entsprechend die andere Flanke des Dreieckgenerators, sodass die 
Frequenz der Dreiecksspannung nurnoch von der Integrationskonstanten so wie 
dem Teilerverhältniss des Mittkopplungszweig abhängig ist.


% Durch die Integration eines Rechtecksignals wird aus diesem ein Dreieck-Signal,
% welches am Ausgang des Integrators abgenommen werden kann.
% Das Ausgangssignal des Dreieckgenerators wird zurück auf den Eingang des 
% Schmitt-Trigger gegeben.
% Durch die Rückkopplung des Dreiecksignals ist 
\subsection{Gedämpfte Sinusschwingung}%
\label{sub:gedaempfte_sinusschwingung}
Zur Erzeugung einer ent-/gedämpften Schwingung werden drei Operationsverstärker
benötigt.
Dabei dienen zwei OPs der Integration und ein weiterer der Invertierung
des Signals für die Rückkopplung.
\begin{figure}[h]
		\centering
		\includegraphics[width=0.8\linewidth]{build/schwingungsdiffgl.pdf}
		\caption{Schaltbild zur Erzeugung gedämpfter und entdämpften Schwingungen. \cite{anleitung}}
		\label{fig:}
\end{figure}

Auf den nicht-invertierenden Eingang des ersten Operationsverstärker wird der
Ausgang des letzten gelegt.
Dieser integriert das Ausgangssignal $U_A$ und gibt seine Ausgangsspannung $U_1$ auf
den Eingang des zweiten Operationsverstärkers, welcher ebenfalls das Signal
integriert:
\begin{equation}
		\label{eq:ov2}
		U_2 = - \frac{1}{RC} \int \left( U_1 + \frac{\eta}{10} U_\text{A} \right) \, dt
\end{equation}
Des Weiteren wird ein Teil des Ausgangssignal $U_\text{A}$ auf den Eingang des
zweiten Operationsverstärkers gelegt, sodass dieser linear mit $\eta$ gedämpft wird.
Der dritte Operationsverstärker invertiert das Vorzeichen, sodass die
Ausgangsspannung durch einen Differentialgleichung 2. Ordnung mit linearer
Rückstellkraft beschrieben werden kann,
\begin{equation}
		\label{eq:schwingung_diff}
		\frac{d^2 U_\text{A}}{dt^2} - \frac{\eta}{10 R C} \frac{d
		U_\text{A}}{dt} + \frac{1}{(RC)^2} U_\text{A} = 0
\end{equation}
dessen Lösung
\begin{equation}
		U_\text{A}(t) = U_0 \exp \left( \frac{\eta t}{20 RC} \right)
    \sin \left(\frac{t}{RC}\right) \label{eq:tau}
\end{equation}
ist.
Die Schwingungsdauer $T$ kann dem Sinusterm
\begin{equation}
	T = 2 \pi R C	
\end{equation}
und die Abklingdauer $\tau$ kann dem
Exponentailterm
\begin{equation}
		\tau = \frac{20 R C}{|\eta|}
\end{equation}
entnommen werden.
